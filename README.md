# Purkinje-Microscopic-MVF

Solve the monodomain equation using Finite Volume Method. 

![Monodomain equation](img/monodomain.jpg)

The project is divided in 4 parts.

- Skeleton_Mesh
- Mesh_Generator
- Pk-Noble
- Pk-LiRudy

# Skeleton_Mesh

- PURPOSE: Build the skeleton for the network mesh.
- INPUT: Length of the fiber
- INPUT: Number of fibers leaving a bifurcation
- INPUT: Type of network
- INPUT: Name of the output file
- The output file is using the .vtk extension.
- To visualize the structure open the output file using Paraview
- There are 3 types of network that could be generated:
  - Fiber with a bifurcation at the endpoints (Type 1);
  - Fiber with iterative growth (Type 2);
  - Fiber with iterative growth and angle control (Type 3). 
- For the Type 2 and 3 network the maximum number of iterations and angle control can be adjusted by the variables MAX_ITER and ANG, respectly.

Build and execute

```sh
$ make
$ ./skeletonMesh <xMax> <biff> <type> <out_VTK_file>
```

Example
```sh
$ ./skeletonMesh 1.0 2 3 example.vtk
```
This example will build a network of type 3 with two segments leaving each bifurcation and a fiber length of 1cm.

![Generated network](img/net1.png)

# Mesh_Generator

  - PURPOSE: Build the mesh network that will be used to solve FVM.
  - INPUT: network generated by the SkeletonMesh program must be provided.
  - INPUT: type of the cell that make up the fiber
    - pig = 68 um
    - dog = 164 um
    - test1 = 75 um
    - test2 = 100 um
    - test3 = 125 um
    - test4 = 150 um
    - test5 = 175 um
    - test6 = 200 um
  - The output file must defined with the extension ".msh".
  - The syntax of the ".msh" file is defined as

![Generated network](img/mesh_structure.png)

Build and execute
```sh
$ make
$ ./meshGenerator example.vtk example.msh
```

### FLAGS

  - These flags are turned on by editing the `Makefile`.
  - \-DDIAMETER: Activate the variable diameter length between each growing iteration (Experiment 4 and 5).

# Pk-Noble

  - PURPOSE: Solve the monodomain equation using the Noble celullar model from 1962 (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1359535/pdf/jphysiol01248-0130.pdf)
  - INPUT: Type of the solution
    - \-t: SteadyState
    - \-s: Solver
  - INPUT: Size of the discretization in time
  - INPUT: Maximum simulation time
  - INPUT: Mesh file generated by the MeshGenerator
  - INPUT: SteadyState filename (use the extension .sst)
  - INPUT: Plot filename (use extension .plt)
  - INPUT: Alpha parameter (for the PMJ simulations)
  - INPUT: Diameter of the Purkinje cell

### FLAGS
